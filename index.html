<!DOCTYPE html>
<htlm>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="description" content="Milestone4: build a shopping cart" />
    <meta name="title" content="Milestone4: Shopping Cart" />
    <link href="./stylesheet.css" type="text/css" rel="stylesheet" />
  </head>
  <body>
    <header>
      <div class="logo">
        <p>
          <img class="logo_img" src="Nonnovino200pxW.png" alt="company logo" />
          <a href="./index.html"></a>
        </p>
      </div>
      <!--Main navigation bar-->
      <nav id="mainmenu">
        <ul>
          <li class="wines"><a href="./index.html">Wines</a></li>
          <li class="nchoice"><a href="./nchoice.html">Nonno's choice</a></li>
          <li class="learnmore"><a href="./learnmore.html">Learn more</a></li>
          <li class="events"><a href="./events.html">Events</a></li>
          <li class="asknonno"><a href="./asknonno.html">Ask nonno</a></li>
        </ul>
      </nav>
    </header>
    <main>
      <h1>Our wine selection</h1>
      <!-- First row of three bottles-->
      <section id="row1">
        <div class="wine_item">
          <!--Gavi wine-->
          <p>
            <img
              class="wine_img"
              src="gavi.jpg"
              alt="white wine Gavi glass bottle with cork 75cl"
            /><a href=".index.html"></a>
          </p>
          <h3 class="wine_name">Gavi di Gavi DOCG</h3>
          <h4 class="origin">from Piedmont</h4>
          <p class="descr">This is a light white from Cortese grapes.</p>
          <span class="price">£15</span>
          <span class="size">per bottle</span>
          <button type="submit" class="AddBtn">Add to Cart</button>
        </div>
        <div class="wine_item">
          <!--Frappato wine-->
          <p>
            <img
              class="wine_img"
              src="frappato.jpg"
              alt="red wine Frappato glass bottle with cork 75cl"
            /><a href=".index.html"></a>
          </p>
          <h3 class="wine_name">Frappato IGP</h3>
          <h4 class="origin">from Sicily</h4>
          <p class="descr">A red wine with a nice structure.</p>
          <span class="price">£10</span>
          <span class="size">per bottle</span>
          <button type="submit" class="AddBtn">Add to Cart</button>
        </div>
        <div class="wine_item">
          <!--Prosecco wine-->
          <p>
            <img
              class="wine_img"
              src="prosecco.jpg"
              alt="sparkling wine Prosecco glass bottle with cork 75cl"
            /><a href=".index.html"></a>
          </p>
          <h3 class="wine_name">Prosecco DOCG</h3>
          <h4 class="origin">from Veneto</h4>
          <p class="descr">Wonderful bubbles, great for celebrations.</p>
          <span class="price">£20</span>
          <span class="size">per bottle</span>
          <button type="submit" class="AddBtn">Add to Cart</button>
        </div>
      </section>
      <!-- Second row of three bottles-->
      <section id="row2">
        <div class="wine_item">
          <!--Lambrusco wine-->
          <p>
            <img
              class="wine_img"
              src="lambrusco.jpg"
              alt="sparkling red wine Lambrusco glass bottle with cork 75cl"
            /><a href=".index.html"></a>
          </p>
          <h3 class="wine_name">Lambrusco DOC</h3>
          <h4 class="origin">from Emilia-Romagna</h4>
          <p class="descr">A light sparkling red. Try it with pizza.</p>
          <span class="price">£16</span>
          <span class="size">per bottle</span>
          <button type="submit" class="AddBtn">Add to Cart</button>
        </div>
        <div class="wine_item">
          <!--Vermentino wine-->
          <p>
            <img
              class="wine_img"
              src="vermentino.jpg"
              alt="white wine Vermentino glass bottle screw cap 75cl"
            /><a href=".index.html"></a>
          </p>
          <h3 class="wine_name">Vermentino DOC</h3>
          <h4 class="origin">from Sardinia</h4>
          <p class="descr">A fresh and fruity white.</p>
          <span class="price">£13</span>
          <span class="size">per bottle</span>
          <button type="submit" class="AddBtn">Add to Cart</button>
        </div>
        <div class="wine_item">
          <!--Chianti wine-->
          <p>
            <img
              class="wine_img"
              src="chianti.jpg"
              alt="Red Chianti glass bottle with cork 75cl"
            /><a href=".index.html"></a>
          </p>
          <h3 class="wine_name">Chianti DOC</h3>
          <h4 class="origin">from Tuscany</h4>
          <p class="descr">Full-bodied with great tannins.</p>
          <span class="price">£25</span>
          <span class="size">per bottle</span>
          <button type="submit" class="AddBtn">Add to Cart</button>
        </div>
      </section>
      <!-- Shopping cart part-->
      <section id="shoppingcart">
        <h2>Shopping Cart</h2>
        <hr class="hor_dot_line" />
        <div class="shop_menu">
          <div>Item</div>
          <div>Price</div>
          <div>Quantity</div>
        </div>
        <hr class="hor_dot_line" />
        <div class="shop_list">
          <!-- <div class="shop_list_row">
            <div class="shop_img_name">
              <img
                class="shop_wine_img"
                src="gavi.jpg"
                alt="wine bottle image"
                height="30"
              />
              <span class="shop_wine_name">Gavi di Gavi</span>
            </div>
            <span class="shop_price">£15</span>
            <div class="shop_quantity_res">
              <input type="number" min="1" id="shop_quantity" value="1" />
              <button type="reset" id="ResBtn">X</button>
            </div>
          </div>
        </div> -->
          <!-- <div class="shop_list_row">
          <div class="shop_img_name">
            <img class="shop_wine_img" src="lambrusco.jpg" alt="placeholder" />
            <span class="shop_wine_name">Lambrusco</span>
          </div>
          <span class="shop_price">£16</span>
          <div class="shop_quantity_res">
            <input type="number" min="1" id="shop_quantity" value="1" />
            <button type="reset" id="ResBtn">X</button>
          </div> -->
        </div>
        <div class="shop_total">
          <div class="total">Total</div>
          <span class="total_price">£00.00</span>
        </div>
        <div class="checkoutBtn">
          <button type="button" class="checkout">Checkout</button>
        </div>
        </section>
      </section>
    </main>
    <!--Footer-->
    <footer id="mainfooter">
      <ul>
        <li>About us</li>
        <li>Terms & Conditions</li>
        <li>All the small print</li>
      </ul>
    </footer>
    <!--Vanilla Javascript below-->
    <script>
      const AddCartBtns = document.querySelectorAll(".AddBtn");
      const cart = [];
      const cartContainer = document.querySelector(".shop_list");
      const totalDisplay = document.querySelector(".total_price");
      let totalPrice = 0;
      const updateCart = () => {
        cartContainer.innerHTML = "";
        cart.forEach(function(item) {
          totalPrice += item.productPrice * item.quantity;
          const el = document.createElement("div");
          el.classList = "shop_list_row";
          el.innerHTML = `
            <div class="shop_img_name">
              <img class="shop_wine_img" src="${item.productImage}" alt="placeholder" height="30" style="/* height: 30px; */ "/>
              <span class="shop_wine_name">${item.productName}</span>
            </div>
            <span class="shop_price">${item.productPrice}</span>
            <div class="shop_quantity_res">
              <input type="number" min="1" id="shop_quantity" value="${item.quantity}" />
              <button type="reset" id="ResBtn">X</button>
            </div>
          </div>`;
          // more magic here!
          cartContainer.appendChild(el);
        });
       
        // update Cart Items Quantity
      };
      const addHandler = event => {
        const productImage = event.target.parentElement.querySelector("img")
          .src;
        const productName = event.target.parentElement.querySelector("h3")
          .innerText;
        const productPrice = +event.target.parentElement
          .querySelector("span")
          .innerText.slice(1);

        let found = false;
        for (let i = 0; i < cart.length; i++) {
          const item = cart[i];
          if (item.productName === productName) {
            found = true;
            item.quantity = item.quantity + 1;
          }
        }
        if (found === false) {
          cart.push({ productImage, productName, productPrice, quantity: 1 });
        }

        updateCart();
      };

      for (let i = 0; i < AddCartBtns.length; i++) {
        AddCartBtns[i].onclick = addHandler;
      };
      // remove cart items


      //Update cart total 
      //function updateCartTotal()
      //const totalAmount = [];
      //const totalDisplay = document.querySelector(".total_price");
      //totalAmount.forEach(function(item){
        //totalAmount.push(parseFloat(totalDisplay.textcontent))
      //});
        //console.log(totalAmount);

      //2nd attempt
      //function updateCartTotal()
      //const cartItemContainer = document.getElementsByClassName("shop_list")[0];
      //const shop_list_rows = cartItemContainer.getElementByClassName("shop_list_row");
      //let total = 0;
      //for (let i = 0; i < shop_list_rows.length; i++) {
      //const shop_list_row = shop_list_rows[i];
      //const priceItem = shop_list_row.getElementsByClassName("shop_price")[0];
      //const quantityItem = shop_list_row.getElementbyIdName("shop_quantity")[0];
      //const totQuantity = quantityItem.value;
      //total = total + (priceItem * quantityItem)
      //};
      //document.getElementByClassName("total_price")[0].innerText = "£" + total;
      //updateCartTotal();
    //};
    


      const ResBtn = document.querySelectorAll(".ResBtn");
      for (let i = 0; i < ResBtn.length; i++) {
        const Clicked = ResBtn[i];
        button.AddEventListener("click", function(event) {
          console.log("clicked");
        })
      }




      //const input = document.getElementById("shop_quantity");
    

      //console.log(ResBtn)
      //for (let i = 0; i < ResBtn.length; i++) {
      // const button = ResBtn[i]
      //button.AddEventListener("click", function(event) {
      //const buttonClicked = event.target
      //console.log("clicked")
      //})
      //}

      //buttonClicked.parentElement.parentElement.remove()
      //updatedShop_total()
      // }   

      //Checkout message

    </script>
  </body>
</htlm>
